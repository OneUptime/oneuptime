<!DOCTYPE html>
<html lang="en" id="home">

<meta http-equiv="content-type" content="text/html;charset=utf-8" />

<head>
    <title>
        <%= blogPost.title %>
    </title>
    <meta name="description" content="<%= blogPost.description %>">
    <%- include('../head-basic') -%>
        <link rel="canonical" href="https://oneuptime.com/blog/post/<%= blogPost.fileName %>/view" />
        <meta property="og:site_name" content="OneUptime | One Complete Observability platform.">
        <meta property="og:type" content="article">
        <meta property="og:title" content="<%= blogPost.title %>">
        <meta property="og:description" content="<%= blogPost.description %>">
        <meta property="og:url" content="<%= blogPost.blogUrl %>">
        <meta property="og:image" content="<%= blogPost.socialMediaImageUrl %>">
        <meta property="article:published_time" content="<%- blogPost.postDate -%>T00:00:00.000Z">
        <meta property="article:modified_time" content="<%- blogPost.postDate -%>T00:00:00.000Z">
        <meta property="article:publisher" content="https://www.facebook.com/OneUptime">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="<%= blogPost.title %>">
        <meta name="twitter:description" content="<%= blogPost.description %>">
        <meta name="twitter:url" content="<%= blogPost.blogUrl %>">
        <meta name="twitter:image" content="<%= blogPost.socialMediaImageUrl %>">
        <meta name="twitter:label1" content="Written by">
        <meta name="twitter:data1" content="<%= blogPost.author.name %>">
        <meta name="twitter:site" content="@OneUptimeHQ">
        <meta property="og:image:width" content="1280">
        <meta property="og:image:height" content="720">
        <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "OneUptime",
        "url": "https://oneuptime.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://oneuptime.com/img/OneUptimePNG/1.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "<%= blogPost.author.name %>",
        "url": "<%= blogPost.author.githubUrl %>",
        "sameAs": []
    },
    "headline": "<%= blogPost.title %>",
    "url": "<%= blogPost.blogUrl %>",
    "datePublished": "<%- blogPost.postDate -%>T00:00:00.000Z",
    "dateModified": "<%- blogPost.postDate -%>T00:00:00.000Z",
    "description": "<%- blogPost.description -%>",
    "mainEntityOfPage": "<%= blogPost.blogUrl %>"
}
    </script>

        <!-- Syntax highlighting with highlight.js - using One Dark theme for colorful code -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/dockerfile.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
        <script>hljs.highlightAll();</script>

        <style>
            body {
                background: radial-gradient(circle at top, #eef2ff, #f8fafc 45%, #ffffff 70%);
                color: #111827;
            }

            .reading-progress {
                position: fixed;
                top: 0;
                left: 0;
                width: 0;
                height: 3px;
                z-index: 60;
                background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);
                transition: width 120ms ease-out;
                box-shadow: 0 0 10px rgba(99, 102, 241, 0.5), 0 0 20px rgba(139, 92, 246, 0.3);
            }

            .floating-share {
                position: absolute;
                left: -5rem;
                top: 0;
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
            }

            .floating-share a {
                width: 2.75rem;
                height: 2.75rem;
                border-radius: 9999px;
                border: 1px solid rgba(148, 163, 184, 0.5);
                display: inline-flex;
                align-items: center;
                justify-content: center;
                background: rgba(255, 255, 255, 0.9);
                box-shadow: 0 10px 30px rgba(15, 23, 42, 0.06);
                transition: all 0.2s ease;
            }

            .floating-share a:hover {
                border-color: #6366f1;
                color: #6366f1;
                transform: translateY(-2px);
            }

            /* Code blocks styling */
            .blog-body pre {
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Consolas', 'Courier New', monospace !important;
                font-size: 14px !important;
                line-height: 1.6 !important;
                font-weight: 400 !important;
                margin-top: 1.75rem !important;
                margin-bottom: 1.75rem !important;
                border: 1px solid rgba(15, 23, 42, 0.1) !important;
                border-radius: 0.75rem !important;
                box-shadow: 0 10px 30px rgba(15, 23, 42, 0.06) !important;
            }

            .blog-body pre code {
                font-family: inherit !important;
                font-size: inherit !important;
                line-height: inherit !important;
                font-weight: inherit !important;
            }

            /* Ensure highlight.js doesn't override our font settings */
            .blog-body .hljs {
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Consolas', 'Courier New', monospace !important;
                font-size: 14px !important;
                line-height: 1.6 !important;
                font-weight: 400 !important;
                padding: 1.25rem !important;
                border-radius: 0.75rem !important;
            }

            /* Inline code chips */
            .blog-body :not(pre) > code {
                font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Consolas', 'Courier New', monospace;
                font-size: 0.80em;
                padding: 0.15rem 0.4rem;
                border-radius: 0.375rem;
                background: rgba(99, 102, 241, 0.08);
                border: 1px solid rgba(99, 102, 241, 0.15);
                color: #4f46e5;
                white-space: nowrap;
            }

            .blog-body :not(pre) > code strong {
                font-weight: 600;
            }

            /* Blockquotes */
            .blog-body blockquote {
                border-left: 3px solid #a5b4fc;
                background: rgba(238, 242, 255, 0.5);
                padding: 1.25rem 1.5rem;
                border-radius: 0 0.75rem 0.75rem 0;
                font-style: normal;
                color: #1f2937;
            }

            .blog-body img {
                border-radius: 1rem;
                box-shadow: 0 20px 50px rgba(15, 23, 42, 0.08);
            }

            .blog-body h2,
            .blog-body h3,
            .blog-body h4 {
                scroll-margin-top: 7rem;
            }

            /* Links */
            .blog-body a:not(.no-underline) {
                text-decoration-color: rgba(99, 102, 241, 0.3);
                text-underline-offset: 3px;
            }

            .blog-body a:not(.no-underline):hover {
                text-decoration-color: rgba(99, 102, 241, 0.6);
            }

            @media (max-width: 1279px) {
                .floating-share {
                    display: none !important;
                }
            }

            /* Back to top button */
            .back-to-top {
                position: fixed;
                bottom: 2rem;
                left: 2rem;
                width: 3rem;
                height: 3rem;
                border-radius: 9999px;
                background: rgba(255, 255, 255, 0.95);
                border: 1px solid rgba(148, 163, 184, 0.3);
                box-shadow: 0 10px 40px rgba(15, 23, 42, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                opacity: 0;
                visibility: hidden;
                transform: translateY(10px);
                transition: all 0.3s ease;
                z-index: 50;
            }

            .back-to-top.visible {
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }

            .back-to-top:hover {
                background: #fff;
                border-color: #6366f1;
                transform: translateY(-3px);
                box-shadow: 0 15px 50px rgba(99, 102, 241, 0.15);
            }

            .back-to-top svg {
                width: 1.25rem;
                height: 1.25rem;
                color: #64748b;
                transition: color 0.2s;
            }

            .back-to-top:hover svg {
                color: #6366f1;
            }

            /* Floating TOC */
            .floating-toc {
                position: fixed;
                top: 50%;
                left: calc(50% + 28rem);
                transform: translateY(-50%);
                max-width: 200px;
                max-height: 60vh;
                z-index: 40;
                opacity: 0;
                visibility: hidden;
                transition: opacity 0.3s ease, visibility 0.3s ease;
            }

            .floating-toc.visible {
                opacity: 1;
                visibility: visible;
            }

            @media (min-width: 1440px) and (max-width: 1599px) {
                .floating-toc {
                    left: calc(50% + 26rem);
                    max-width: 180px;
                }
            }

            .floating-toc-inner {
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(148, 163, 184, 0.3);
                border-radius: 1rem;
                padding: 1rem;
                box-shadow: 0 10px 40px rgba(15, 23, 42, 0.08);
            }

            .floating-toc-inner:hover {
                box-shadow: 0 15px 50px rgba(15, 23, 42, 0.12);
                border-color: rgba(99, 102, 241, 0.3);
            }

            /* TOC active state */
            #toc a.toc-active {
                color: #4f46e5;
                font-weight: 500;
            }

            #toc a {
                position: relative;
                padding-left: 0.75rem;
                display: block;
                padding-top: 0.25rem;
                padding-bottom: 0.25rem;
                font-size: 0.8125rem;
                line-height: 1.4;
                color: #64748b;
                text-decoration: none;
                transition: color 0.2s;
            }

            #toc a:hover {
                color: #6366f1;
            }

            #toc a::before {
                content: '';
                position: absolute;
                left: 0;
                top: 0.35rem;
                bottom: 0.35rem;
                width: 2px;
                background: transparent;
                border-radius: 1px;
                transition: background 0.2s;
            }

            #toc a.toc-active::before {
                background: #6366f1;
            }

            #toc a.toc-h3 {
                padding-left: 1.25rem;
                font-size: 0.75rem;
                color: #94a3b8;
            }

            #toc a.toc-h3::before {
                left: 0.5rem;
            }

            @media (max-width: 1279px) {
                .floating-toc {
                    display: none !important;
                }
            }

            @media (min-width: 1280px) and (max-width: 1439px) {
                .floating-toc {
                    left: calc(50% + 24rem);
                    max-width: 160px;
                }
            }

            /* Smooth scroll behavior */
            html {
                scroll-behavior: smooth;
            }
        </style>

</head>


<body>
    <div class="reading-progress" id="reading-progress"></div>
    <!-- Back to top button -->
    <button class="back-to-top" id="back-to-top" aria-label="Back to top" title="Back to top">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
        </svg>
    </button>

    <!-- Floating TOC -->
    <div class="floating-toc" id="floating-toc">
        <div class="floating-toc-inner">
            <h2 class="text-xs font-semibold tracking-wider text-indigo-600 uppercase mb-3 flex items-center gap-2">
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/></svg>
                On this page
            </h2>
            <nav id="toc" aria-label="Table of contents" class="overflow-y-auto max-h-[50vh] pr-1"></nav>
        </div>
    </div>

    <%- include('../nav') -%>

        <div class="relative isolate overflow-hidden bg-gradient-to-b from-white via-white to-gray-50/40">
            <!-- Subtle decorative background blurs -->
            <div class="absolute inset-0 -z-10 overflow-hidden pointer-events-none">
                <div class="absolute top-10 left-1/4 w-96 h-96 bg-indigo-50 rounded-full mix-blend-multiply filter blur-3xl opacity-30"></div>
                <div class="absolute top-20 right-1/4 w-96 h-96 bg-purple-50 rounded-full mix-blend-multiply filter blur-3xl opacity-30"></div>
            </div>

            <!-- Hero / Title Section -->
            <div class="pt-20 pb-12 sm:pt-28 sm:pb-20">
                <div class="mx-auto max-w-4xl px-6 lg:px-8 text-center relative">
                    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-gray-900 leading-tight">
                        <%= blogPost.title %>
                    </h1>
                    <p class="mt-6 text-xl text-gray-600 leading-relaxed max-w-3xl mx-auto">
                        <%= blogPost.description %>
                    </p>
                    <div class="mt-8 flex flex-wrap items-center justify-center gap-4 text-sm text-gray-500">
                        <% if(blogPost.author){ %>
                        <a href="<%- blogPost.author.githubUrl -%>" target="_blank" class="flex items-center space-x-2 group">
                            <!-- Added explicit width & height to stabilize layout (CLS) -->
                            <img class="h-8 w-8 rounded-full ring-2 ring-gray-200 group-hover:ring-gray-400 transition" src="<%- blogPost.author.profileImageUrl -%>" alt="<%- blogPost.author.name -%>" width="32" height="32" decoding="async">
                            <span class="font-medium text-gray-700 group-hover:text-gray-900 transition">@<%- blogPost.author.username -%></span>
                        </a>
                        <span class="hidden sm:inline select-none">•</span>
                        <span><%- blogPost.formattedPostDate -%></span>
                        <span class="hidden sm:inline select-none">•</span>
                        <% } %>
                        <span id="reading-time" class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-indigo-50 border border-indigo-100 text-indigo-600">
                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            <span class="sr-only">Reading time</span>
                        </span>
                    </div>
                    <div class="mt-8">
                        <%- include('./Partials/Tags', { blogPost: blogPost }) -%>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="pb-24">
                <div class="mx-auto max-w-4xl px-6 lg:px-8">
                    <div>
                        <!-- Main content -->
                        <article>
                            <div class="relative">
                                <div class="floating-share hidden xl:flex" aria-label="Share this article">
                                    <a title="Share on X" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=<%- encodeURIComponent(blogPost.title) -%>&url=<%- encodeURIComponent(blogPost.blogUrl) -%>">
                                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M17.53 3h3.77l-8.26 9.45L23 21h-6.17l-4.8-6.01L6.4 21H2.62l8.63-9.87L1 3h6.32l4.33 5.41L17.53 3Zm-1.33 15.62h2.09L7.94 4.29H5.71l10.49 14.33Z"/></svg>
                                    </a>
                                    <a title="Share on LinkedIn" target="_blank" rel="noopener" href="https://www.linkedin.com/sharing/share-offsite/?url=<%- encodeURIComponent(blogPost.blogUrl) -%>">
                                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.049c.476-.9 1.637-1.85 3.37-1.85 3.601 0 4.266 2.37 4.266 5.455v6.286ZM5.337 7.433a2.062 2.062 0 1 1 0-4.124 2.062 2.062 0 0 1 0 4.124ZM7.119 20.452H3.553V9h3.566v11.452ZM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003Z"/></svg>
                                    </a>
                                    <a title="Discuss on Hacker News" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=<%- encodeURIComponent(blogPost.blogUrl) -%>&t=<%- encodeURIComponent(blogPost.title) -%>">
                                        <svg class="w-4 h-4" viewBox="0 0 24 24" aria-hidden="true">
                                            <circle cx="12" cy="12" r="10" fill="currentColor" opacity="0.92"></circle>
                                            <path d="M7.2 6.2L12 12.8l4.8-6.6M12 13.4V17.8" fill="none" stroke="#ffffff" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"></path>
                                        </svg>
                                    </a>
                                </div>
                                <div class="blog-body prose prose-gray max-w-none prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-semibold lg:prose-headings:scroll-mt-[8.5rem] prose-a:font-semibold prose-a:text-gray-600 hover:prose-a:text-gray-500 prose-img:rounded-xl prose-pre:rounded-xl prose-code:text-gray-600">
                                    <%- blogPost.htmlBody -%>
                                </div>
                            </div>

                            <!-- Share -->
                            <div class="mt-14 border-t border-gray-200/70 pt-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6">
                                <div class="text-sm font-medium text-gray-600">Share this article</div>
                                <div class="flex gap-3">
                                    <a title="Share on X" target="_blank" rel="noopener" class="group inline-flex items-center justify-center h-9 w-9 rounded-lg border border-gray-200 hover:border-gray-400 hover:bg-gray-100 transition" href="https://twitter.com/intent/tweet?text=<%- encodeURIComponent(blogPost.title) -%>&url=<%- encodeURIComponent(blogPost.blogUrl) -%>">
                                        <svg class="w-4 h-4 text-gray-500 group-hover:text-gray-600" viewBox="0 0 24 24" fill="currentColor"><path d="M17.53 3h3.77l-8.26 9.45L23 21h-6.17l-4.8-6.01L6.4 21H2.62l8.63-9.87L1 3h6.32l4.33 5.41L17.53 3Zm-1.33 15.62h2.09L7.94 4.29H5.71l10.49 14.33Z"/></svg>
                                    </a>
                                    <a title="Share on LinkedIn" target="_blank" rel="noopener" class="group inline-flex items-center justify-center h-9 w-9 rounded-lg border border-gray-200 hover:border-gray-400 hover:bg-gray-100 transition" href="https://www.linkedin.com/sharing/share-offsite/?url=<%- encodeURIComponent(blogPost.blogUrl) -%>">
                                        <svg class="w-4 h-4 text-gray-500 group-hover:text-gray-600" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.049c.476-.9 1.637-1.85 3.37-1.85 3.601 0 4.266 2.37 4.266 5.455v6.286ZM5.337 7.433a2.062 2.062 0 1 1 0-4.124 2.062 2.062 0 0 1 0 4.124ZM7.119 20.452H3.553V9h3.566v11.452ZM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003Z"/></svg>
                                    </a>
                                    <a title="Discuss on Hacker News" target="_blank" rel="noopener" class="group inline-flex items-center justify-center h-9 w-9 rounded-lg border border-gray-200 hover:border-gray-400 hover:bg-gray-100 transition" href="https://news.ycombinator.com/submitlink?u=<%- encodeURIComponent(blogPost.blogUrl) -%>&t=<%- encodeURIComponent(blogPost.title) -%>">
                                        <svg class="w-4 h-4 text-gray-500 group-hover:text-gray-600" viewBox="0 0 24 24" aria-hidden="true">
                                            <circle cx="12" cy="12" r="10" fill="currentColor" opacity="0.92"></circle>
                                            <path d="M7.2 6.2L12 12.8l4.8-6.6M12 13.4V17.8" fill="none" stroke="#ffffff" stroke-width="1.9" stroke-linecap="round" stroke-linejoin="round"></path>
                                        </svg>
                                    </a>
                                </div>
                            </div>

                            <!-- Author -->
                            <% if(blogPost.author){ %>
                            <div class="mt-16 p-6 sm:p-8 rounded-2xl bg-gradient-to-br from-gray-50 to-indigo-50/30 border border-gray-200/80 shadow-sm hover:shadow-md transition-shadow duration-300">
                                <div class="flex flex-col sm:flex-row gap-5 sm:gap-6 items-start">
                                    <!-- Added explicit width/height + lazy loading for below-the-fold author bio image -->
                                    <div class="relative">
                                        <img class="h-16 w-16 sm:h-20 sm:w-20 rounded-full ring-4 ring-white shadow-md" src="<%- blogPost.author.profileImageUrl -%>" alt="<%- blogPost.author.name -%>" width="80" height="80" loading="lazy" decoding="async">
                                        <div class="absolute -bottom-1 -right-1 h-6 w-6 bg-green-400 rounded-full border-2 border-white flex items-center justify-center">
                                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <h3 class="text-lg font-semibold text-gray-900"><%- blogPost.author.name -%></h3>
                                            <span class="text-xs font-medium text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded-full">Author</span>
                                        </div>
                                        <p class="text-sm text-gray-500 mb-3">@<%- blogPost.author.username -%> • <%- blogPost.formattedPostDate -%> • <span id="reading-time-inline"></span></p>
                                        <div class="text-sm text-gray-600 leading-relaxed"><%- blogPost.author.bio || 'Building reliable software at OneUptime. Follow along for more on observability & reliability.' -%></div>
                                        <div class="mt-4 flex flex-wrap gap-3">
                                            <a href="<%- blogPost.author.githubUrl -%>" target="_blank" class="text-xs font-medium text-gray-600 hover:text-gray-900 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-white border border-gray-200 hover:border-gray-300 shadow-sm transition-all duration-200">
                                                <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                                                GitHub
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% } %>

                            <div class="mt-20">
                                <%- include('./Partials/OpenSourceCommitment', { blogPost: blogPost }) -%>
                            </div>
                        </article>
                    </div>
                </div>
            </div>
        </div>




        <%- include('./Partials/BlogCta') -%>
            <%- include('../footer') -%>
            <script>
                (function(){
                    // Reading time
                    try {
                        const container = document.querySelector('.blog-body');
                        if(container){
                            const text = container.textContent || '';
                            const words = text.trim().split(/\s+/).filter(Boolean).length;
                            const minutes = Math.max(1, Math.round(words / 200));
                            const rt = minutes + ' min read';
                            const el = document.getElementById('reading-time');
                            if(el){ el.insertAdjacentText('beforeend', rt); }
                            const el2 = document.getElementById('reading-time-inline');
                            if(el2){ el2.textContent = rt; }
                        }
                    } catch (e) {}

                    // Reading progress indicator
                    try {
                        const progressBar = document.getElementById('reading-progress');
                        const target = document.querySelector('.blog-body');
                        if(progressBar && target){
                            let start = 0;
                            let end = 0;
                            const recalc = () => {
                                const rect = target.getBoundingClientRect();
                                const scrollTop = window.scrollY || window.pageYOffset;
                                start = scrollTop + rect.top - 120;
                                end = start + target.offsetHeight;
                            };
                            const update = () => {
                                if(!end){ recalc(); }
                                const scrollPos = window.scrollY || window.pageYOffset;
                                const distance = end - start;
                                if(distance <= 0){ return; }
                                const progress = Math.min(1, Math.max(0, (scrollPos - start) / distance));
                                progressBar.style.width = (progress * 100).toFixed(2) + '%';
                            };
                            recalc();
                            window.addEventListener('scroll', update, { passive: true });
                            window.addEventListener('resize', () => {
                                end = 0;
                                recalc();
                                update();
                            });
                            update();
                        }
                    } catch (e) {}

                    // TOC with active state tracking and visibility based on content position
                    try {
                        const container = document.querySelector('.blog-body');
                        if(!container){ return; }
                        const headings = container.querySelectorAll('h2, h3');
                        if(!headings.length){ return; }
                        const toc = document.getElementById('toc');
                        const floatingToc = document.getElementById('floating-toc');
                        if(!toc){ return; }
                        const tocLinks = [];
                        headings.forEach(h => {
                            if(!h.id){
                                h.id = h.textContent.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'');
                            }
                            const a = document.createElement('a');
                            a.href = '#' + h.id;
                            a.textContent = h.textContent;
                            a.className = h.tagName === 'H3' ? 'toc-h3' : '';
                            a.dataset.target = h.id;
                            toc.appendChild(a);
                            tocLinks.push({ link: a, heading: h });
                        });

                        // Track active TOC item and visibility on scroll
                        const updateToc = () => {
                            const scrollPos = window.scrollY + 150;
                            let activeIndex = 0;
                            tocLinks.forEach((item, i) => {
                                const rect = item.heading.getBoundingClientRect();
                                const top = rect.top + window.scrollY;
                                if(scrollPos >= top){
                                    activeIndex = i;
                                }
                            });
                            tocLinks.forEach((item, i) => {
                                if(i === activeIndex){
                                    item.link.classList.add('toc-active');
                                } else {
                                    item.link.classList.remove('toc-active');
                                }
                            });

                            // Show/hide floating TOC based on blog content position
                            if(floatingToc){
                                const rect = container.getBoundingClientRect();
                                const contentTop = rect.top;
                                const contentBottom = rect.bottom;
                                const viewportHeight = window.innerHeight;

                                // Show TOC when content top has scrolled past the top of viewport
                                // and content bottom is still below the middle of the viewport
                                const shouldShow = contentTop < 100 && contentBottom > viewportHeight * 0.4;

                                if(shouldShow){
                                    floatingToc.classList.add('visible');
                                } else {
                                    floatingToc.classList.remove('visible');
                                }
                            }
                        };
                        window.addEventListener('scroll', updateToc, { passive: true });
                        updateToc();
                    } catch (e) {}

                    // Back to top button
                    try {
                        const backToTopBtn = document.getElementById('back-to-top');
                        if(backToTopBtn){
                            const toggleVisibility = () => {
                                if(window.scrollY > 400){
                                    backToTopBtn.classList.add('visible');
                                } else {
                                    backToTopBtn.classList.remove('visible');
                                }
                            };
                            window.addEventListener('scroll', toggleVisibility, { passive: true });
                            toggleVisibility();
                            backToTopBtn.addEventListener('click', () => {
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                            });
                        }
                    } catch (e) {}

                    // Stabilize images inside blog body (add width/height if missing & lazy-load non-hero images)
                    try {
                        const imgs = document.querySelectorAll('.blog-body img');
                        imgs.forEach((img, index) => {
                            // If width/height already specified, skip dimension inference
                            if(!img.hasAttribute('width') || !img.hasAttribute('height')){
                                if(img.naturalWidth && img.naturalHeight){
                                    img.setAttribute('width', img.naturalWidth);
                                    img.setAttribute('height', img.naturalHeight);
                                } else {
                                    // If not yet loaded, attach a one-time listener
                                    img.addEventListener('load', function handler(){
                                        if(!img.hasAttribute('width') && img.naturalWidth){ img.setAttribute('width', img.naturalWidth); }
                                        if(!img.hasAttribute('height') && img.naturalHeight){ img.setAttribute('height', img.naturalHeight); }
                                        img.removeEventListener('load', handler);
                                    });
                                }
                            }
                            // Lazy-load images after the first one (often top/hero) for better LCP while reducing CLS
                            if(index > 0 && !img.hasAttribute('loading')){
                                img.setAttribute('loading', 'lazy');
                            }
                            if(!img.hasAttribute('decoding')){
                                img.setAttribute('decoding', 'async');
                            }
                            // Ensure display block for centered images without causing late shifts
                            if(!img.className.includes('inline') && !img.className.includes('block')){
                                img.classList.add('block');
                            }
                        });
                    } catch(e) {}

                    // Mermaid diagrams
                    try {
                        const mermaidCodeBlocks = document.querySelectorAll('.blog-body pre code.language-mermaid, .blog-body pre code.mermaid, .blog-body pre code[class*="language-mermaid"], .blog-body pre code[class*="mermaid"]');
                        if(mermaidCodeBlocks.length){
                            // Dynamically load Mermaid only if needed to avoid extra payload on pages without diagrams
                            const script = document.createElement('script');
                            script.src = 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js';
                            script.async = true;
                            script.onload = () => {
                                if(!window.mermaid){ return; }
                                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                                window.mermaid.initialize({
                                    startOnLoad: false,
                                    securityLevel: 'loose', // Content is trusted (owned blog); allows links & styling
                                    theme: prefersDark ? 'dark' : 'default'
                                });
                                mermaidCodeBlocks.forEach((codeEl, i) => {
                                    // Avoid double-processing
                                    if(codeEl.dataset.mermaidProcessed){ return; }
                                    const pre = codeEl.closest('pre');
                                    if(!pre){ return; }
                                    const def = codeEl.textContent.trim(); // Use textContent to ignore highlight.js span wrappers
                                    const container = document.createElement('div');
                                    container.className = 'mermaid my-6';
                                    // Provide a deterministic ID (optional)
                                    container.id = 'mermaid-diagram-' + (i+1);
                                    container.textContent = def;
                                    pre.replaceWith(container);
                                    codeEl.dataset.mermaidProcessed = 'true';
                                });
                                try { window.mermaid.run && window.mermaid.run(); } catch(_) {}
                            };
                            document.head.appendChild(script);
                        }
                    } catch(e) {}
                })();
            </script>
</body>

</html>